# Implementation Plan - Setup UI Layout with UI Builder Packages

## Technical Context

**Architecture:**

- The feature implements the client-side layout structure (Sidebar, Header, Main) within the React + Vite application.
- It integrates `@openzeppelin/ui-builder-ui` and `@openzeppelin/ui-builder-styles` packages.
- Packages are installed as local tarballs (`.tgz`) generated by `pack-ui-builder.sh`.
- Styling is driven by Tailwind CSS, inheriting configuration from the UI Builder package.
- Routing will be prepared (placeholder) to support the "Home" link, likely using React Router (standard in this stack).

**Dependencies:**

- `@openzeppelin/ui-builder-ui`: Source of UI components (Sidebar, Header, Logo, etc.).
- `@openzeppelin/ui-builder-styles`: Source of Tailwind config and base styles.
- `vite`: Build tool (existing).
- `react-router-dom`: For navigation (assumed existing or to be added).
- `tailwindcss`: CSS utility framework (existing or to be configured).
- `postcss`: CSS processing (existing).

**Integrations:**

- **Local Monorepo**: The build process relies on `../ui-builder` (via the pack script) to source dependencies.
- **Tailwind**: The local Tailwind config must extend or import the UI Builder's config/preset.

**Configuration:**

- `package.json`: Update dependencies to point to local `.tgz` files.
- `tailwind.config.js`: Extend from UI Builder's preset.
- `postcss.config.js`: Standard PostCSS setup.
- `vite.config.ts`: Ensure alias resolution works for the packed modules if needed (usually standard import works).

## Constitution Check

| Principle              | Status  | Notes                                                                    |
| :--------------------- | :------ | :----------------------------------------------------------------------- |
| **I. Adapter-Led**     | N/A     | Layout feature is presentation-only; no adapter logic involved yet.      |
| **II. Reuse-First**    | ✅ PASS | Explicitly uses `@openzeppelin/ui-builder-*` packages via local tarball. |
| **III. Type Safety**   | ✅ PASS | Layout components will be typed; imports from UI Builder are typed.      |
| **IV. UI Consistency** | ✅ PASS | Inherits Tailwind theme and components from UI Builder.                  |
| **V. TDD**             | ✅ PASS | Can test layout rendering and routing independence.                      |
| **VI. Tooling**        | ✅ PASS | Uses Vite, local scripts, and client-side routing.                       |

**Gate Evaluation:**

- All relevant principles passed.
- Reuse of UI Builder packages is central to this feature, aligning perfectly with Principle II.
- Local tarball workflow matches Principle II requirements.

## Phase 0: Research & Validation

**Goal:** Validate package integration and layout structure options.

1. **Validate Package Exports**:
   - _Unknown_: Does `@openzeppelin/ui-builder-ui` export the specific `Sidebar`, `Header` (or `Navbar`), and `Logo` components we need?
   - _Task_: Check the `ui-builder` repo (locally) to list exported components from the `ui` package.
   - _Output_: Confirmation of component names to use in implementation.

2. **Validate Tailwind Config Inheritance**:
   - _Unknown_: How exactly does `@openzeppelin/ui-builder-styles` expose its config? Is it a preset or a base file?
   - _Task_: Inspect `packages/styles` in the builder repo to see the export format (e.g., `tailwind.config.js` or `preset.js`).
   - _Output_: Correct syntax for `tailwind.config.js` in Role Manager.

3. **Validate Icon Availability**:
   - _Unknown_: Does the UI package export a generic Logo or Icon component suitable for the sidebar?
   - _Task_: Check `packages/ui` or `packages/icons` (if it exists) in the builder repo.
   - _Output_: Import path for the logo component.

## Phase 1: Design & Contracts

**Goal:** Define the component structure and route hierarchy.

1. **Component Hierarchy Design**:
   - Define the `Layout` component structure (wrapper for Sidebar + Content).
   - Define the `App` root structure (Providers -> Router -> Layout -> Routes).
   - Define the `Sidebar` configuration (links array structure).

2. **Routing Structure**:
   - Define the route for `/` (Home).
   - Placeholder for future routes.

3. **API Contracts**:
   - N/A (Client-side only feature).

## Phase 2: Implementation

**Goal:** Build the layout and integrate packages.

1. **Package Integration**:
   - Run `pack-ui-builder.sh` to generate tarballs.
   - `npm install` / `pnpm add` the generated tarballs (`file:...`).
   - Verify `node_modules` structure.

2. **Tailwind Setup**:
   - Configure `tailwind.config.js` to use the UI Builder preset.
   - Configure `postcss.config.js`.
   - Create/Update `index.css` to import base Tailwind directives.

3. **Component Implementation**:
   - Create `src/components/Layout/MainLayout.tsx`:
     - Import `Sidebar`, `Header` from `ui-builder-ui`.
     - Implement responsive structure (desktop sidebar, mobile drawer if available or simple stack).
   - Create `src/pages/Home.tsx`:
     - Simple placeholder content.
   - Update `src/App.tsx`:
     - Setup `BrowserRouter`.
     - Use `MainLayout`.
     - Define Routes.

4. **Verification**:
   - Run `pnpm dev`.
   - Visually check Sidebar, Header, and styles.
   - Verify "Home" link works.

## Phase 3: Testing & Refinement

**Goal:** Ensure robustness and mobile responsiveness.

1. **Unit Tests**:
   - Test `MainLayout` renders children.
   - Test navigation links are present.

2. **Mobile Check**:
   - Resize window to verify layout behavior (responsive requirements).
   - Fix any overflow or overlapping issues.

3. **Cleanup**:
   - Remove any temporary setup artifacts.
   - Ensure linting passes.
